<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>HIV/AIDS Deaths Trends</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="timeline.html">HIV/AIDS Timeline</a>
</li>
<li>
  <a href="data.html">Data cleaning/processing</a>
</li>
<li>
  <a href="trends.html">Trends</a>
</li>
<li>
  <a href="dashboard.html">Dashboard</a>
</li>
<li>
  <a href="regression.html">Analysis</a>
</li>
<li>
  <a href="report.html">Final Project Report</a>
</li>
<li>
  <a href="https://www.youtube.com/watch?v=Bg8tbmppoIA">
    <span class="fa fa-brands fa-youtube"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/juancambeiro1/hiv_trends.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">HIV/AIDS Deaths Trends</h1>

</div>


<div id="global-trend-of-hiv-mortality-per-100k-population-1990-to-2019"
class="section level3">
<h3>Global trend of HIV mortality per 100k population: 1990 to 2019</h3>
<p>We plot the estimated global HIV mortality per 100k population across
200 countries from 1990 to 2019. The estimated global HIV mortality rate
increased from 1990 to 2004, peaked in 2004, and then fell from 2005 to
2019. The global HIV mortality rate in 2004 was 2.88 per 100k
population. In 2019, the global HIV mortality rate decreased to 1.13 per
100k population.</p>
<pre class="r"><code>death_year = maindata %&gt;%
 group_by(year) %&gt;%
 summarize(HIV_death = sum(val),
           pop_year  = sum(population, na.rm = T)) %&gt;%
 mutate(HIV_death = as.numeric(HIV_death),
        mortality_per_100k = HIV_death/(pop_year/100000))



plot_death_year = death_year %&gt;%
ggplot(aes(x = as.factor(year), y = mortality_per_100k, group=1)) + 
  geom_line(col = &quot;deepskyblue3&quot;, size = 1) + 
  geom_point(col = &quot;deepskyblue3&quot;, size = 2) + 
  theme(axis.text.x = element_text(angle = -90, hjust = 0)) +  
  labs(
    title = &quot;Global Trend of HIV deaths Per 100k Population: 1990 to 2019&quot;,
    x = &quot;Year&quot;, 
    y = &quot;Estimated HIV deaths per 100k population&quot;
  ) 

plot_death_year + transition_reveal(year)</code></pre>
<p><img src="trends_files/figure-html/unnamed-chunk-2-1.gif" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div
id="global-trend-of-hiv-mortality-per-100k-population-by-sex-1990-to-2019"
class="section level3">
<h3>Global trend of HIV mortality per 100k population by sex: 1990 to
2019</h3>
<p>The trajectories of estimated global HIV mortality for females and
males from 1990 to 2019 were similar. Before 1994 and after 2015, the
difference in the HIV mortality rate between females and males was
virtually indistinguishable. But from 1994 to 2015, the yearly global
HIV mortality rate for females was higher than that for males. The
average HIV mortality rate in females across 30 years was 2.01 per 100k
population. The average HIV mortality rate in males across 30 years was
1.75 per 100k population.</p>
<pre class="r"><code>death_gender = maindata %&gt;% 
  group_by(year, sex_name) %&gt;% 
  summarize(HIV_death = sum(val),
            pop_year  = sum(population, na.rm = T)) %&gt;% 
  mutate(
    HIV_death = as.numeric(HIV_death),
        year = as.numeric(year),
    mortality_per_100k = HIV_death/(pop_year/100000))

plot_death_gender = death_gender %&gt;% 
  ggplot(aes(x = year, y = mortality_per_100k, col=factor(sex_name))) + 
  geom_line() + 
  geom_point() +
  labs(title = &quot;Global Trend of HIV deaths Per 100k Population over time by Sex&quot;, 
       x = &quot;Year&quot;, 
       y = &quot;Estimated HIV deaths per 100k population&quot;, 
       color = &quot;Sex&quot;) + 
  scale_x_continuous(breaks = seq(1990, 2019, 5), minor_breaks = F)

plot_death_gender + transition_reveal(year)</code></pre>
<p><img src="trends_files/figure-html/unnamed-chunk-3-1.gif" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div
id="global-trend-of-hiv-mortality-per-100k-population-by-age-1990-to-2019"
class="section level3">
<h3>Global trend of HIV mortality per 100k population by Age: 1990 to
2019</h3>
<p>Generally, the estimated global HIV mortality rates from 1990 to 2019
were the highest among young or middle-aged adults (25-49 years), and
were the lowest among the elderly (75+ years). Among young or
middle-aged adults, the global HIV mortality rate changed the most from
1990 to 2019, with the peak occurring in 2004. The mortality trends were
more stable for people in other age groups (0-9 years, 10-24 years,
50-74 years, and 75+ years). Among the people aged over 75 years old,
the global HIV mortality rates during the 30 years were low and stable.
The average HIV mortality rate in young and middle-aged adults (25-49
years) across 30 years was 5.94 per 100k population. The average HIV
mortality rate in elderly (75+ years) across 30 years was 0.053 per 100k
population.</p>
<pre class="r"><code>death_age = maindata %&gt;% 
  group_by(year, age_name) %&gt;% 
  summarize(HIV_death = sum(val),
            pop_year  = sum(population, na.rm = T)) %&gt;% 
  mutate(
    HIV_death = as.numeric(HIV_death),
    year = as.numeric(year),
    mortality_per_100k = HIV_death/(pop_year/100000))

plot_death_age = death_age %&gt;% 
  ggplot(aes(x = year, y = mortality_per_100k, col = factor(age_name))) +
  geom_line() + 
  geom_point() + 
  labs(title = &quot;Global Trend of HIV deaths Per 100k Population over time by Age&quot;, 
       x = &quot;Year&quot;, 
       y = &quot;Estimated HIV deaths per 100k population&quot;, 
       color = &quot;Age&quot;) + 
  scale_x_continuous(breaks = seq(1990, 2019, 5), minor_breaks = F)

plot_death_age + transition_reveal(year)</code></pre>
<p><img src="trends_files/figure-html/unnamed-chunk-4-1.gif" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="hiv-mortality-rate-by-country-gdp-per-capita-1990-to-2019"
class="section level3">
<h3>HIV Mortality Rate by Country GDP Per Capita: 1990 to 2019</h3>
<p>We next wanted to explore the relationship between GDP per capita and
HIV mortality per 100k. The below graph shows there was a non-linear
negative association between the estimated global HIV mortality rates in
the past 30 years and the country GDP. The countries with lower GDP had
higher HIV mortality rate. This may be indicative of the fact that
poorer countries do not have adequate resources to avert otherwise
preventable HIV/AIDS deaths.</p>
<pre class="r"><code>hiv_country &lt;- maindata %&gt;% group_by(year,country_name,gdp_per_capita) %&gt;% summarise(death=sum(val),pop = sum(population, na.rm=TRUE)) %&gt;% mutate(mortality_per_100k=((death)/(pop))*100000)

plot_death_GDP &lt;- ggplot(hiv_country, aes(x = gdp_per_capita, y=mortality_per_100k, colour = country_name)) +
  geom_point(show.legend = FALSE, alpha = 0.7) +
  scale_color_viridis_d(option = &quot;F&quot;) +
  scale_size(range = c(2, 12)) +
  scale_x_log10() +
  labs(x = &quot;GDP per capita&quot;, y = &quot;HIV Mortality per 100k&quot;)

plot_death_GDP + transition_time(as.integer(year))+ labs(title = &quot;Year: {frame_time}&quot;) + shadow_wake(wake_length = 0.1, alpha = FALSE)</code></pre>
<p><img src="trends_files/figure-html/unnamed-chunk-5-1.gif" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="hiv-mortality-by-country-1990-to-2019" class="section level3">
<h3>HIV mortality by Country: 1990 to 2019</h3>
<p>We additionally wanted to look at how countries rank in terms of
their number of HIV/AIDS deaths. First, we show the 10 countries with
the highest total number of HIV/AIDS deaths.</p>
<pre class="r"><code>top_10 &lt;- maindata %&gt;% group_by(country_name) %&gt;% summarise(count=sum(val)) %&gt;% arrange(desc(count)) %&gt;% head(n=10)
top_10$count &lt;- format(top_10$count, big.mark=&quot;,&quot;)

knitr::kable(top_10) %&gt;%
  kable_styling(full_width = F) %&gt;%
  column_spec(1, width = &quot;50%&quot;) %&gt;%
  column_spec(2, width = &quot;50%&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
country_name
</th>
<th style="text-align:left;">
count
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 50%; ">
South Africa
</td>
<td style="text-align:left;width: 50%; ">
4,874,295
</td>
</tr>
<tr>
<td style="text-align:left;width: 50%; ">
Kenya
</td>
<td style="text-align:left;width: 50%; ">
2,583,538
</td>
</tr>
<tr>
<td style="text-align:left;width: 50%; ">
United Republic of Tanzania
</td>
<td style="text-align:left;width: 50%; ">
2,465,046
</td>
</tr>
<tr>
<td style="text-align:left;width: 50%; ">
India
</td>
<td style="text-align:left;width: 50%; ">
2,454,374
</td>
</tr>
<tr>
<td style="text-align:left;width: 50%; ">
Nigeria
</td>
<td style="text-align:left;width: 50%; ">
2,216,719
</td>
</tr>
<tr>
<td style="text-align:left;width: 50%; ">
Uganda
</td>
<td style="text-align:left;width: 50%; ">
2,102,166
</td>
</tr>
<tr>
<td style="text-align:left;width: 50%; ">
Zimbabwe
</td>
<td style="text-align:left;width: 50%; ">
1,836,041
</td>
</tr>
<tr>
<td style="text-align:left;width: 50%; ">
Ethiopia
</td>
<td style="text-align:left;width: 50%; ">
1,788,431
</td>
</tr>
<tr>
<td style="text-align:left;width: 50%; ">
Mozambique
</td>
<td style="text-align:left;width: 50%; ">
1,541,267
</td>
</tr>
<tr>
<td style="text-align:left;width: 50%; ">
Malawi
</td>
<td style="text-align:left;width: 50%; ">
1,265,348
</td>
</tr>
</tbody>
</table>
<p>Next, we show the 10 countries with the highest total number of
HIV/AIDS deaths for each year from 1990 to 2019.</p>
<pre class="r"><code>knitr::opts_chunk$set(
 echo = FALSE,
 fig.width = 7, 
 fig.height = 5,
 fig.asp = 0.6,
 out.width = &quot;70%&quot;)
theme_set(theme_bw() + 
          theme(legend.position = &quot;bottom&quot;,
                legend.title = element_blank(),
                plot.title = element_text(hjust = 0.5, size = 15),
                plot.subtitle = element_text(hjust = 0.5, size = 12)))

hiv_sub&lt;-maindata %&gt;% select(country_name,year,sex_id,val)

n&lt;-unique(hiv_sub$country_name)
country&lt;-function(x){
  hiv2&lt;-hiv_sub %&gt;% filter(country_name==x)
  sum(hiv2$val)
}
country_total&lt;-sapply(n,function(x) country(x))

top_hiv&lt;- hiv_sub %&gt;% filter(country_name %in% c(
  &quot;South Africa&quot;,
  &quot;Kenya&quot;,
  &quot;United Republic of Tanzania&quot;,
  &quot;India&quot;,
  &quot;Nigeria&quot;,
  &quot;Uganda&quot;,
  &quot;Zimbabwe&quot;,
  &quot;Ethiopia&quot;,
  &quot;Mozambique&quot;,
  &quot;Malawi&quot;,
  &quot;Zambia&quot;,
  &quot;Cote d&#39;Ivoire&quot;,
  &quot;Democratic Republic of Congo&quot;,
  &quot;Cameroon&quot;,
  &quot;Thailand&quot;,
  &quot;United States of America&quot;))

top_hiv$sex&lt;-as.factor(top_hiv$sex_id)

hiv3&lt;-aggregate(val~country_name+year,top_hiv,sum) %&gt;% 
  group_by(year) %&gt;% 
  mutate(rank = min_rank(-val)) %&gt;%
  ungroup()

static_plot&lt;-ggplot(hiv3,aes(rank,group=country_name,fill=as.factor(country_name),color=as.factor(country_name))) +
 geom_tile(aes(y = val/2,height = val, width = 0.9), alpha = 0.8, color = NA) +
 geom_text(aes(y = 0, label = paste(country_name, &#39; &#39;)), vjust = 0.2, hjust = 1) +
 geom_text(aes(y=val,label = paste(&#39; &#39;,val)), hjust=0)+
 coord_flip(clip = &#39;off&#39;, expand = TRUE) +
 scale_y_continuous(labels = scales::comma) +
 scale_x_reverse() +
 guides(color = FALSE, fill = FALSE) +
 theme_minimal() +
 theme(
 plot.title=element_text(size=30, hjust=0.5, face=&#39;bold&#39;, colour=&#39;black&#39;, vjust=-1),
 plot.subtitle=element_text(size=18, hjust=0.5, face=&#39;italic&#39;, color=&#39;black&#39;),
 plot.caption =element_text(size=8, hjust=0.5, face=&#39;italic&#39;, color=&#39;black&#39;),
 axis.ticks.y = element_blank(), 
 axis.text.y = element_blank(), 
 plot.margin = margin(1,1,1,4, &#39;cm&#39;)
 )
plt&lt;-static_plot + transition_states(states = year, transition_length = 4, state_length = 1) + 
 ease_aes(&#39;cubic-in-out&#39;) +
 labs(title = &#39;HIV Deaths per Year : {closest_state}&#39;, 
 x=&#39;&#39;,y=&#39;HIV Deaths per year&#39;)

final_animation&lt;-animate(plt,100,fps = 20,duration = 30, width = 1000, height = 950, renderer = gifski_renderer())

final_animation</code></pre>
<p><img src="trends_files/figure-html/unnamed-chunk-7-1.gif" width="60%" style="display: block; margin: auto;" /></p>
<p>Now we show a table of the 10 countries with the highest total number
of HIV/AIDS deaths adjusted for population size, as well as an animation
of how the top 10 has changed between 1990 and 2019.</p>
</div>
<div id="top-10-countries-with-highest-hiv-mortality-per-100k"
class="section level3">
<h3>Top 10 countries with highest HIV mortality per 100k</h3>
<pre class="r"><code>death_country = maindata %&gt;%
 group_by(country_name) %&gt;%
 summarize(HIV_death = sum(val, na.rm = T),
           pop_year  = sum(population, na.rm = T)) %&gt;%
 mutate(
   HIV_death = as.integer(HIV_death)) %&gt;%
 mutate(
   HIV_death = as.numeric(HIV_death),
        count_per_100k = HIV_death/(pop_year/100000))
top_10_high = death_country %&gt;%
 filter(count_per_100k != &#39;Inf&#39;) %&gt;%
 arrange(desc(count_per_100k)) %&gt;%
 mutate(count_per_100k = round(count_per_100k, digits=4)) %&gt;%
 head(n = 10) %&gt;%
 select(country_name, count_per_100k)
knitr::kable(top_10_high) %&gt;% 
  kable_styling(full_width = F) %&gt;%
  column_spec(1, width = &quot;65%&quot;) %&gt;%
  column_spec(2, width = &quot;35%&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
country_name
</th>
<th style="text-align:right;">
count_per_100k
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 65%; ">
Lesotho
</td>
<td style="text-align:right;width: 35%; ">
54.3809
</td>
</tr>
<tr>
<td style="text-align:left;width: 65%; ">
Eswatini
</td>
<td style="text-align:right;width: 35%; ">
50.6240
</td>
</tr>
<tr>
<td style="text-align:left;width: 65%; ">
Zimbabwe
</td>
<td style="text-align:right;width: 35%; ">
49.5544
</td>
</tr>
<tr>
<td style="text-align:left;width: 65%; ">
Botswana
</td>
<td style="text-align:right;width: 35%; ">
49.0797
</td>
</tr>
<tr>
<td style="text-align:left;width: 65%; ">
South Africa
</td>
<td style="text-align:right;width: 35%; ">
33.9966
</td>
</tr>
<tr>
<td style="text-align:left;width: 65%; ">
Malawi
</td>
<td style="text-align:right;width: 35%; ">
32.4034
</td>
</tr>
<tr>
<td style="text-align:left;width: 65%; ">
Zambia
</td>
<td style="text-align:right;width: 35%; ">
32.2501
</td>
</tr>
<tr>
<td style="text-align:left;width: 65%; ">
Namibia
</td>
<td style="text-align:right;width: 35%; ">
26.7923
</td>
</tr>
<tr>
<td style="text-align:left;width: 65%; ">
Mozambique
</td>
<td style="text-align:right;width: 35%; ">
24.7988
</td>
</tr>
<tr>
<td style="text-align:left;width: 65%; ">
Uganda
</td>
<td style="text-align:right;width: 35%; ">
24.6188
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>knitr::opts_chunk$set(
 echo = FALSE,
 fig.width = 7, 
 fig.height = 5,
 fig.asp = 0.6,
 out.width = &quot;70%&quot;)
theme_set(theme_bw() + 
          theme(legend.position = &quot;bottom&quot;,
                legend.title = element_blank(),
                plot.title = element_text(hjust = 0.5, size = 15),
                plot.subtitle = element_text(hjust = 0.5, size = 12)))

hiv_sub&lt;-maindata %&gt;% select(country_name,year,sex_id,val, population)

top_hiv&lt;- hiv_sub %&gt;% filter(country_name %in% c(
  &quot;Lesotho&quot;,
  &quot;Eswatini&quot;,
  &quot;Zimbabwe&quot;,
  &quot;Botswana&quot;,
  &quot;South Africa&quot;,
  &quot;Malwai&quot;,
  &quot;Zambia&quot;,
  &quot;Nambia&quot;,
  &quot;Mozambique&quot;,
  &quot;Uganda&quot;,
  &quot;Central African Republic&quot;,
  &quot;Kenya&quot;,
  &quot;Cameroon&quot;,
  &quot;Burundi&quot;,
  &quot;Equatorial Guinea&quot;))

hiv3&lt;-top_hiv %&gt;%
   group_by(year, country_name) %&gt;%
 summarize(HIV_death = sum(val, na.rm = T),
           pop_year  = sum(population, na.rm = T)) %&gt;%
 mutate(
   HIV_death = as.integer(HIV_death)
 ) %&gt;%
 mutate(
   HIV_death = as.numeric(HIV_death),
        motality_per_100k =     HIV_death/(pop_year/100000)) %&gt;%
  mutate(rank = min_rank(-motality_per_100k)) %&gt;%
  ungroup() %&gt;%
    select(-HIV_death, -pop_year)

static_plot&lt;-ggplot(hiv3,aes(rank,group=country_name,fill=as.factor(country_name),color=as.factor(country_name))) +
 geom_tile(aes(y = motality_per_100k/2,height = motality_per_100k, width = 0.9), alpha = 0.8, color = NA) + 
 geom_text(aes(y = 0, label = paste(country_name, &#39; &#39;)), vjust = 0.2, hjust = 1) +
 geom_text(aes(y=motality_per_100k,label = paste(&#39; &#39;,motality_per_100k)), hjust=0)+
 coord_flip(clip = &#39;off&#39;, expand = TRUE) +
 scale_y_continuous(labels = scales::comma) +
 scale_x_reverse() +
 guides(color = FALSE, fill = FALSE) +
 theme_minimal() +
 theme(
 plot.title=element_text(size=30, hjust=0.5, face=&#39;bold&#39;, colour=&#39;black&#39;, vjust=-1),
 plot.subtitle=element_text(size=18, hjust=0.5, face=&#39;italic&#39;, color=&#39;black&#39;),
 plot.caption =element_text(size=8, hjust=0.5, face=&#39;italic&#39;, color=&#39;black&#39;),
 axis.ticks.y = element_blank(), 
 axis.text.y = element_blank(), 
 plot.margin = margin(1,1,1,4, &#39;cm&#39;)
 )

plt&lt;-static_plot + transition_states(states = year, transition_length = 4, state_length = 1) + 
 ease_aes(&#39;cubic-in-out&#39;) +
 labs(title = &#39;HIV Mortality Rate per 100k by Year : {closest_state}&#39;, 
 x=&#39;&#39;,y=&#39;HIV Mortality Rate by Year&#39;)

hivrate_animation&lt;-animate(plt,100,fps = 20,duration = 30, width = 950, height = 750, renderer = gifski_renderer())

hivrate_animation</code></pre>
<p><img src="trends_files/figure-html/unnamed-chunk-9-1.gif" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="top-10-countries-with-lowest-hiv-mortality-per-100k"
class="section level3">
<h3>Top 10 countries with lowest HIV mortality per 100k</h3>
<p>Finally we show a table of the 10 countries with the lowest total
number of HIV/AIDS deaths adjusted for population size, as well as an
animation of how the top 10 has changed between 1990 and 2019.</p>
<pre class="r"><code>top_10_low = death_country %&gt;%
 filter(count_per_100k != &#39;Inf&#39;) %&gt;%
 arrange(count_per_100k) %&gt;% head(n = 10) %&gt;%
 mutate(count_per_100k = round(count_per_100k, digits = 4)) %&gt;%
 select(country_name, count_per_100k)
knitr::kable(top_10_low) %&gt;%
  kable_styling(full_width = F) %&gt;%
  column_spec(1, width = &quot;60%&quot;) %&gt;%
  column_spec(2, width = &quot;40%&quot;)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
country_name
</th>
<th style="text-align:right;">
count_per_100k
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 60%; ">
Albania
</td>
<td style="text-align:right;width: 40%; ">
0.0057
</td>
</tr>
<tr>
<td style="text-align:left;width: 60%; ">
Slovakia
</td>
<td style="text-align:right;width: 40%; ">
0.0078
</td>
</tr>
<tr>
<td style="text-align:left;width: 60%; ">
Bosnia and Herzegovina
</td>
<td style="text-align:right;width: 40%; ">
0.0079
</td>
</tr>
<tr>
<td style="text-align:left;width: 60%; ">
North Macedonia
</td>
<td style="text-align:right;width: 40%; ">
0.0087
</td>
</tr>
<tr>
<td style="text-align:left;width: 60%; ">
Kuwait
</td>
<td style="text-align:right;width: 40%; ">
0.0103
</td>
</tr>
<tr>
<td style="text-align:left;width: 60%; ">
Syrian Arab Republic
</td>
<td style="text-align:right;width: 40%; ">
0.0105
</td>
</tr>
<tr>
<td style="text-align:left;width: 60%; ">
Bangladesh
</td>
<td style="text-align:right;width: 40%; ">
0.0109
</td>
</tr>
<tr>
<td style="text-align:left;width: 60%; ">
Czechia
</td>
<td style="text-align:right;width: 40%; ">
0.0114
</td>
</tr>
<tr>
<td style="text-align:left;width: 60%; ">
Egypt
</td>
<td style="text-align:right;width: 40%; ">
0.0122
</td>
</tr>
<tr>
<td style="text-align:left;width: 60%; ">
Comoros
</td>
<td style="text-align:right;width: 40%; ">
0.0125
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>knitr::opts_chunk$set(
 echo = FALSE,
 fig.width = 7, 
 fig.height = 5,
 fig.asp = 0.6,
 out.width = &quot;70%&quot;)
theme_set(theme_bw() + 
          theme(legend.position = &quot;bottom&quot;,
                legend.title = element_blank(),
                plot.title = element_text(hjust = 0.5, size = 15),
                plot.subtitle = element_text(hjust = 0.5, size = 12)))

hiv_sub_2&lt;-maindata %&gt;% select(country_name,year,sex_id,val, population)

low_hiv&lt;- hiv_sub_2 %&gt;% filter(country_name %in% c(
  &quot;Albania&quot;,
  &quot;Bosnia and Herzegovina&quot;,
  &quot;North Macedonia&quot;,
  &quot;Kuwait&quot;,
  &quot;Syrian Arab Republic&quot;,
  &quot;Bangladesh&quot;,
  &quot;Czechia&quot;,
  &quot;Comoros&quot;,
  &quot;Maldives&quot;,
  &quot;Japan&quot;,
  &quot;Iraq&quot;,
  &quot;Slovenia&quot;,
  &quot;Jordan&quot;,
  &quot;Finland&quot;,
  &quot;Croatia&quot;))

hiv3_2&lt;-low_hiv %&gt;%
   group_by(year, country_name) %&gt;%
 summarize(HIV_death = sum(val, na.rm = T),
           pop_year  = sum(population, na.rm = T)) %&gt;%
 mutate(
   HIV_death = as.integer(HIV_death)
 ) %&gt;%
 mutate(
   HIV_death = as.numeric(HIV_death),
        motality_per_100k =     HIV_death/(pop_year/100000)) %&gt;%
  mutate(rank = row_number(motality_per_100k)) %&gt;%
  ungroup() %&gt;%
    select(-HIV_death, -pop_year)


static_plot&lt;-ggplot(hiv3_2,aes(rank,group=country_name,fill=as.factor(country_name),color=as.factor(country_name))) +
 geom_tile(aes(y = motality_per_100k/2,height = motality_per_100k, width = 0.9), alpha = 0.8, color = NA) + 
 geom_text(aes(y = 0, label = paste(country_name, &#39; &#39;)), vjust = 0.2, hjust = 1) +
 geom_text(aes(y=motality_per_100k,label = paste(&#39; &#39;,motality_per_100k)), hjust=0)+
 coord_flip(clip = &#39;off&#39;, expand = TRUE) +
 scale_y_continuous(labels = scales::comma) +
 scale_x_reverse() +
 guides(color = FALSE, fill = FALSE) +
 theme_minimal() +
 theme(
 plot.title=element_text(size=30, hjust=0.5, face=&#39;bold&#39;, colour=&#39;black&#39;, vjust=-1),
 plot.subtitle=element_text(size=18, hjust=0.5, face=&#39;italic&#39;, color=&#39;black&#39;),
 plot.caption =element_text(size=8, hjust=0.5, face=&#39;italic&#39;, color=&#39;black&#39;),
 axis.ticks.y = element_blank(), 
 axis.text.y = element_blank(), 
 plot.margin = margin(1,1,1,4, &#39;cm&#39;)
 )

plt&lt;-static_plot + transition_states(states = year, transition_length = 4, state_length = 1) + 
 ease_aes(&#39;cubic-in-out&#39;) +
 labs(title = &#39;HIV Mortality Rate per 100k by Year : {closest_state}&#39;, 
 x=&#39;&#39;,y=&#39;HIV Mortality Rate by Year&#39;)

hivrate_animation2&lt;-animate(plt,100,fps = 20,duration = 30, width = 950, height = 750, renderer = gifski_renderer())

hivrate_animation2</code></pre>
<p><img src="trends_files/figure-html/unnamed-chunk-11-1.gif" width="70%" style="display: block; margin: auto;" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
